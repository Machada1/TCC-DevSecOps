{"version":"1.144.1","results":[{"check_id":"yaml.kubernetes.security.run-as-non-root.run-as-non-root","path":"Instrumentos/Codigos/DevSecOps/dvwa/k8s/dvwa.yaml","start":{"line":16,"col":5,"offset":227},"end":{"line":16,"col":9,"offset":231},"extra":{"message":"When running containers in Kubernetes, it's important to ensure that they  are properly secured to prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to run  applications as the root user, which could allow an attacker to gain  access to sensitive resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container, with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-root user,  limiting the damage that could be caused by any potential attacks. By  adding a `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your containerized applications are more secure and  less vulnerable to privilege escalation attacks.","fix":"spec:\n      securityContext:\n        runAsNonRoot: true #","metadata":{"references":["https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/","https://kubernetes.io/docs/concepts/policy/pod-security-policy/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-2-set-a-user"],"category":"security","cwe":["CWE-250: Execution with Unnecessary Privileges"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"technology":["kubernetes"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.run-as-non-root.run-as-non-root","shortlink":"https://sg.run/dgP5"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","path":"Instrumentos/Codigos/DevSecOps/dvwa/k8s/dvwa.yaml","start":{"line":18,"col":11,"offset":261},"end":{"line":18,"col":15,"offset":265},"extra":{"message":"In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.","fix":"securityContext:\n            allowPrivilegeEscalation: false\n          name","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation","https://kubernetes.io/docs/tasks/configure-pod-container/security-context/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["kubernetes"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","shortlink":"https://sg.run/eleR"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.run-as-non-root.run-as-non-root","path":"Instrumentos/Codigos/DevSecOps/dvwa/k8s/mysql.yaml","start":{"line":27,"col":5,"offset":377},"end":{"line":27,"col":9,"offset":381},"extra":{"message":"When running containers in Kubernetes, it's important to ensure that they  are properly secured to prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to run  applications as the root user, which could allow an attacker to gain  access to sensitive resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container, with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-root user,  limiting the damage that could be caused by any potential attacks. By  adding a `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your containerized applications are more secure and  less vulnerable to privilege escalation attacks.","fix":"spec:\n      securityContext:\n        runAsNonRoot: true #","metadata":{"references":["https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/","https://kubernetes.io/docs/concepts/policy/pod-security-policy/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-2-set-a-user"],"category":"security","cwe":["CWE-250: Execution with Unnecessary Privileges"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"technology":["kubernetes"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.run-as-non-root.run-as-non-root","shortlink":"https://sg.run/dgP5"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","path":"Instrumentos/Codigos/DevSecOps/dvwa/k8s/mysql.yaml","start":{"line":29,"col":11,"offset":411},"end":{"line":29,"col":15,"offset":415},"extra":{"message":"In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.","fix":"securityContext:\n            allowPrivilegeEscalation: false\n          name","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation","https://kubernetes.io/docs/tasks/configure-pod-container/security-context/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["kubernetes"],"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext","shortlink":"https://sg.run/eleR"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":[".github/.keep","Artigo/Artigo-Corrigido.pdf","Artigo/Artigo.pdf","Artigo/README.md","Artigo/esboco.md","Artigo/pre-projeto.md","CITATION.cff","Divulgacao/Apresentacao/Apresentação Projeto DevSecOps.pdf","Divulgacao/Apresentacao/README.md","Divulgacao/Video/README.md","Fichamentos/Fichamento-An Empirical Study of DevSecOps Focused on Continuous Security Testing.md","Fichamentos/Fichamento-Continuous Security Testing: A Case Study on Integrating Dynamic Security Testing Tools in CICD Pipelines.md","Fichamentos/Fichamento-Implementation of DevSecOps by Integrating Static and Dynamic Security Testing in CICD PipelinesCD Pipelines.md","Fichamentos/Fichamento-Implementing and Automating Security Scanning to a DevSecOps CICD Pipeline.md","Fichamentos/Fichamento-Integrating Security with DevSecOps: Techniques and Challenges.md","Fichamentos/README.md","Fichamentos/TemplateDeFichamento.md","Fichamentos/analiseEscrita.md","Instrumentos/Codigos/DevSecOps/dvwa/cloudbuild-test.yaml","Instrumentos/Codigos/DevSecOps/dvwa/cloudbuild.yaml","Instrumentos/Codigos/DevSecOps/dvwa/k8s/dvwa.yaml","Instrumentos/Codigos/DevSecOps/dvwa/k8s/mysql.yaml","Instrumentos/Codigos/DevSecOps/infra/.gitignore","Instrumentos/Codigos/DevSecOps/infra/apis.tf","Instrumentos/Codigos/DevSecOps/infra/artifact-registry.tf","Instrumentos/Codigos/DevSecOps/infra/cloudbuild.tf","Instrumentos/Codigos/DevSecOps/infra/gke.tf","Instrumentos/Codigos/DevSecOps/infra/iam.tf","Instrumentos/Codigos/DevSecOps/infra/outputs.tf","Instrumentos/Codigos/DevSecOps/infra/provider.tf","Instrumentos/Codigos/DevSecOps/infra/storage.tf","Instrumentos/Codigos/DevSecOps/infra/terraform.tfvars","Instrumentos/Codigos/DevSecOps/infra/variables.tf","Instrumentos/Codigos/DevSecOps/infra/vpc.tf","Instrumentos/Codigos/README.md","Instrumentos/OutrosInstrumentos/README.md","LICENSE","Memorial/README.md","README.md","reports/trivy-sca-report.json","terraform.tfstate"]},"time":{"rules":[],"rules_parse_time":2.6197900772094727,"profiling_times":{"config_time":4.626776218414307,"core_time":4.706850051879883,"ignores_time":0.0048792362213134766,"total_time":9.339781522750854},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":1.5110461711883545,"per_file_time":{"mean":0.015418838481513819,"std_dev":0.001904262479235189},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9628936700966636,"rules_selected_ratio":0.20361708762082945,"rules_matched_ratio":0.20361708762082945},"targets":[],"total_bytes":0,"max_memory_bytes":1216071744},"engine_requested":"OSS","skipped_rules":[],"profiling_results":[]}